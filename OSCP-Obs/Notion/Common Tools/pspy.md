```
./pspy64 -r /bin,/etc,/home,/opt,/var,/usr,/tmp -pf -i 1000
```
### **`-r` 参数（watch directories）**

指定要监听的目录列表。  
只要监控到这些目录里的任何可执行文件/脚本被运行，pspy 就会打印出来。

监控目录包括：

- `/bin` — 系统命令
    
- `/etc` — 配置脚本（cron、systemd 等）
    
- `/home` — 用户脚本（提权常在这里）
    
- `/opt` — 自定义程序（高频提权来源）
    
- `/var` — 日志任务、服务脚本
    
- `/usr` — 系统工具
    
- `/tmp` —攻击者和系统临时脚本
    

---

### **`-pf` 参数（print fork）**

`-p` = 打印进程启动  
`-f` = 打印 fork 事件（子进程）

组合成 `-pf` 的作用：

> **显示所有进程的启动 + 父子进程关系。**

这样能清楚看到：

- 谁启动了谁
    
- 进程是什么用户执行的
    
- 进程链路（root → script → command）
    
- 自动化任务行为
    

---

### **`-i 1000`（interval 毫秒）**

扫描间隔（毫秒），也就是：

`每 1000 ms（1 秒）扫描一次`